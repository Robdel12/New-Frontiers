---
import BaseLayout from '../layouts/BaseLayout.astro'
import { Image } from 'astro:assets'
import { getCollection } from 'astro:content'
import bioPortrait from '../assets/images/robert-deluca-portrait.jpeg'

let posts = await getCollection('posts')
posts = posts.sort((a, b) => new Date(b.data.date) - new Date(a.data.date))
// Get only the most recent 5 posts for the timeline
posts = posts.slice(0, 5)
---

<BaseLayout>
  <div class="bio-container">
    <div class="image">
      <Image
        src={bioPortrait}
        alt="Robert DeLuca Portrait"
        width={195}
        height={195}
        format="webp"
        quality={85}
      />
    </div>
    <div class="bio">
      <h3 class="headline">
        Hi, I'm <span>Robert DeLuca</span>!
      </h3>
      <p>
        I'm a software engineer who loves building awesome, accessible front-end
        experiences‚Äîweb, native apps, or APIs, I've done it all. I've spent time
        delving deep into visual testing at Percy (now BrowserStack), where I
        created a plethora of content and supported developer communities. I
        even contributed to helping Visa Checkout achieve WCAG 2.0 compliance,
        ensuring accessibility for millions.
      </p>

      <p>
        Tech always excites me‚Äîwhether it's tinkering with IoT gadgets,
        experimenting with Large Language Models, or building products like
        <a href="https://vizzly.dev" target="_blank" rel="noopener">Vizzly</a> (visual testing for modern teams),
        <a href="https://snoot.support" target="_blank" rel="noopener">Snoot</a> (real-time customer chat), and
        <a href="https://github.com/Robdel12/OrbitDock" target="_blank" rel="noopener">OrbitDock</a> (mission control for AI coding agents).
      </p>

      <p>
        When I step away from the keyboard, you'll find me wrenching on my 1995
        NA8 Spec Miata (#20) or racing it in the SCCA Spec Miata Southwest
        Division. Nothing beats the thrill of chasing the perfect lap! üèéÔ∏èüèÅ
      </p>

      <p>Let's connect and geek out sometime!</p>
    </div>
  </div>

  <div class="timeline-container">
    {
      posts.map((post) => {
        let date = new Date(post.data.date)
        let year = date.getFullYear()
        let month = String(date.getMonth() + 1).padStart(2, '0')
        let day = String(date.getDate()).padStart(2, '0')
        let cleanSlug = post.slug.replace(/^\d{4}-\d{2}-\d{2}-/, '')
        let url = `/${year}/${month}/${day}/${cleanSlug}`
        let formattedDate = date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'short',
          day: 'numeric',
        })

        return (
          <a href={url}>
            <div class="dot" />
            <div class="date">{formattedDate}</div>
            <h2 class="title">{post.data.title}</h2>
            {post.data.excerpt && (
              <p class="description">{post.data.excerpt}</p>
            )}
          </a>
        )
      })
    }

    <div style="text-align: center; margin: 60px 0 40px 0;">
      <a
        href="/blog"
        style="display: inline-block; background: linear-gradient(135deg, #006EFF 0%, #0056CC 100%); color: white; padding: 16px 32px; border-radius: 12px; text-decoration: none; font-weight: 600; font-size: 16px; box-shadow: 0 8px 24px rgba(0, 110, 255, 0.3); transition: all 0.3s ease; border: 1px solid rgba(255, 255, 255, 0.2);"
      >
        View All Posts ‚Üí
      </a>
    </div>
  </div>
</BaseLayout>
